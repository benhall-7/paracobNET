<UserControl xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="https://github.com/avaloniaui"
    xmlns:vm="clr-namespace:prcEditor.ViewModels;assembly=prcEditor"
    x:Class="prcEditor.Views.ParamSearch"
    x:DataType="vm:ParamSearchViewModel">

    <Border Padding="8" BorderThickness="1" Margin="4">
        <Grid RowDefinitions="Auto,Auto,*" RowSpacing="4">
            <!-- Search bar -->
            <StackPanel Orientation="Horizontal" Spacing="4" Grid.Row="0">
                <TextBox Width="180"
                    Watermark="Search hash / label"
                    Text="{Binding Query, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                    <TextBox.KeyBindings>
                        <KeyBinding Gesture="Enter"
                            Command="{Binding RunSearchCommand}" />
                    </TextBox.KeyBindings>
                </TextBox>

                <CheckBox Content="Exact match"
                    IsChecked="{Binding ExactMatch, Mode=TwoWay}" />

                <Button Content="Search"
                    Command="{Binding RunSearchCommand}" />
            </StackPanel>

            <!-- Result count -->
            <TextBlock Grid.Row="1"
                FontSize="11"
                Foreground="Gray"
                Text="{Binding Results.Count, StringFormat='Matches: {0}'}" />

            <!-- Results list -->
            <ListBox Grid.Row="2"
                ItemsSource="{Binding Results}"
                SelectedItem="{Binding SelectedResult, Mode=TwoWay}"
                SelectionMode="Single">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="1">
                            <!-- Main line: node / hash info -->
                            <TextBlock Text="{Binding DisplayText}" />

                            <!-- Route (smaller, gray) -->
                            <TextBlock Text="{Binding RouteText}"
                                FontSize="10"
                                Foreground="Gray" />
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Grid>
    </Border>
</UserControl>